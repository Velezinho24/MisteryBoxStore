{% extends "base.html" %}
{% load i18n static %}
{% load humanize %}

{% block title %}{{ box.name }} · MysteryVault{% endblock %}

{% block content %}
<div class="container mt-4">

  <!-- Header de la caja -->
  <div class="text-center mb-4">
    <h1 class="h3 text-white">{{ box.name }}</h1>
    <p class="text-secondary">{{ box.description|default:_("No description available.") }}</p>
    <h4 class="fw-bold text-danger">$ {{ box.price_cop|intcomma }}</h4>
  </div>

  <!-- Grid de productos incluidos -->
  <h4 class="text-white mb-3">{% trans "Included products" %}</h4>
  <div class="row g-3">
    {% for p in products %}
    <div class="col-12 col-sm-6 col-lg-4">
      <div class="card bg-dark border-danger-subtle h-100 hover-rise">
        {% if p.image %}
          <img src="{{ p.image.url }}" class="card-img-top" alt="{{ p.name }}">
        {% else %}
          <img src="{% static 'img/placeholder-300x200.png' %}" class="card-img-top" alt="{{ p.name }}">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h3 class="h6 mb-1 text-white">{{ p.name }}</h3>
          <div class="small text-secondary mb-2">
            {% if p.tags %}{{ p.tags }}{% endif %}
          </div>
          <div class="mt-auto fw-bold text-danger">$ {{ p.price_cop|intcomma }}</div>
        </div>
      </div>
    </div>
    {% empty %}
    <div class="col-12">
      <div class="alert alert-dark border-danger-subtle text-center">
        {% trans "This box has no products." %}
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Botón para añadir la caja al carrito -->
  <div class="text-center mt-4">
    <form method="post" action="{% url 'orders:add_to_cart' %}">
      {% csrf_token %}
      <input type="hidden" name="type" value="mysterybox">
      <input type="hidden" name="id" value="{{ box.id }}">
      <button type="submit" class="btn btn-danger btn-lg">
        <i class="bi bi-gift"></i> {% trans "Add Mystery Box to cart" %}
      </button>
    </form>
  </div>

</div>
{% endblock %}
